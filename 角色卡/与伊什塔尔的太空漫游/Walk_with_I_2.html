```
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>与伊什塔尔漫步宇宙 - 选择你的命运</title>
  <style>
    :root {
      --primary-color: #800000;
      --secondary-color: #4a0000;
      --accent-color: #ffcc00;
      --background-color: #0a0a0a;
      --text-color: #e0e0e0;
      --card-bg: rgba(30, 20, 20, 0.8);
      --panel-bg: rgba(40, 20, 20, 0.9);
      --border-color: #800000;
      --warning-color: #ff6b6b;
      --success-color: #4ecdc4;
      --input-bg: rgba(60, 40, 40, 0.7);
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      margin: 0;
      padding: 0;
      background-image: url('https://images.unsplash.com/photo-1506318137071-a8e063b4bec0?q=80&w=1470&auto=format&fit=crop');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background-color: var(--panel-bg);
      border-radius: 8px;
      border-bottom: 3px solid var(--accent-color);
    }

    h1,
    h2,
    h3 {
      color: var(--accent-color);
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }

    h2 {
      font-size: 1.8rem;
      margin-top: 30px;
      border-bottom: 2px solid var(--primary-color);
      padding-bottom: 10px;
    }

    .form-section {
      background-color: var(--card-bg);
      padding: 25px;
      margin-bottom: 30px;
      border-radius: 8px;
      border-left: 4px solid var(--primary-color);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
    }

    .selection-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .selection-option {
      background-color: var(--input-bg);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .selection-option:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(255, 204, 0, 0.3);
      border-color: var(--accent-color);
    }

    .selection-option.selected {
      border-color: var(--accent-color);
      background-color: rgba(128, 0, 0, 0.4);
      box-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
    }

    .selection-option h3 {
      margin-top: 0;
      color: var(--accent-color);
    }

    input[type="radio"],
    input[type="checkbox"] {
      display: none;
    }

    label {
      display: block;
      width: 100%;
      cursor: pointer;
    }

    .form-group {
      margin-bottom: 20px;
    }

    textarea {
      width: 100%;
      padding: 12px;
      background-color: var(--input-bg);
      border: 1px solid var(--border-color);
      border-radius: 5px;
      color: var(--text-color);
      resize: vertical;
      min-height: 100px;
    }

    button {
      background-color: var(--primary-color);
      color: var(--text-color);
      border: none;
      padding: 12px 30px;
      font-size: 1.1rem;
      border-radius: 5px;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: bold;
      transition: all 0.3s ease;
      margin-top: 20px;
      display: block;
      width: 100%;
      max-width: 300px;
      margin: 30px auto;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    button:hover {
      background-color: var(--secondary-color);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
      transform: translateY(-2px);
    }

    #creation-form {
      display: block;
    }

    #summary-page {
      display: none;
      background-color: var(--card-bg);
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6);
      border-left: 4px solid var(--accent-color);
    }

    .summary-item {
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .summary-item h3 {
      margin-bottom: 5px;
      color: var(--accent-color);
    }

    .icon {
      display: inline-block;
      width: 24px;
      height: 24px;
      margin-right: 8px;
      vertical-align: middle;
    }

    .event-description {
      font-style: italic;
      color: #aaa;
      margin-top: 10px;
    }

    #servant-image {
      max-width: 100%;
      border-radius: 8px;
      margin-top: 10px;
      border: 2px solid var(--border-color);
    }

    .aquila {
      text-align: center;
      margin: 20px 0;
      font-size: 2rem;
      color: var(--accent-color);
    }

    .lore-text {
      font-style: italic;
      color: #aaa;
      text-align: center;
      margin: 15px 0;
      font-size: 0.9rem;
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <h1>伊什塔尔漫步宇宙</h1>
      <p class="lore-text">"在冷酷黑暗的遥远未来，唯有战争"</p>
      <div class="aquila">≡][≡</div>
    </header>

    <div id="creation-form">
      <!-- 选择阵营 -->
      <section class="form-section">
        <h2>选择你的阵营</h2>
        <p>在这个分裂的银河系中，选择你效忠的势力。</p>

        <div class="selection-grid">
          <div class="selection-option" data-value="地球联合国">
            <input type="radio" name="faction" id="faction1" value="地球联合国">
            <label for="faction1">
              <h3>地球联合国</h3>
              <p>拥有强大科技与军事力量的联合政府，掌控着人类核心世界。和平主义、亲外主义、民主主义。数千年的时光已经蛀空地球联合国的上上下下。</p>
              <p class="event-description">特长：先进武器、技术支援、庞大舰队</p>
            </label>
          </div>

          <div class="selection-option" data-value="人类联邦">
            <input type="radio" name="faction" id="faction2" value="人类联邦"">
            <label for=" faction2">
            <h3>人类联邦</h3>
            <p>由深空中的人类殖民地逐步组成的联邦。军国主义、排外主义、威权主义。无尽的战斗已经使人类联邦摇摇欲坠。</p>
            <p class="event-description">特长：精锐部队、坚固防御、灵活战术</p>
            </label>
          </div>

          <div class="selection-option" data-value="人类沦陷区反抗军">
            <input type="radio" name="faction" id="faction3" value="人类沦陷区反抗军">
            <label for="faction3">
              <h3>人类沦陷区反抗军</h3>
              <p>在被异星种族占领的人类世界中组织的游击队。极端军国主义。派系众多、人心不齐。</p>
              <p class="event-description">特长：游击战、隐匿能力、适应力强</p>
            </label>
          </div>
        </div>
      </section>

      <!-- 选择从者 -->
      <section class="form-section">
        <h2>选择你的契约从者</h2>
        <p>选择一位来自Fate系列的强大英灵，作为你在这场宇宙战争中的盟友。</p>

        <div class="selection-grid">
          <div class="selection-option" data-value="阿尔托莉雅·潘德拉贡">
            <input type="radio" name="servant" id="servant1" value="阿尔托莉雅·潘德拉贡">
            <label for="servant1">
              <h3>阿尔托莉雅·潘德拉贡</h3>
              <p>亚瑟王，圆桌骑士之首。在这个宇宙战场上，她的誓约之剑被改造成能摧毁战舰的能量武器。</p>
              <p class="event-description">特长：领导力、正面突击、战术判断</p>
            </label>
          </div>

          <div class="selection-option" data-value="吉尔伽美什">
            <input type="radio" name="servant" id="servant2" value="吉尔伽美什">
            <label for="servant2">
              <h3>吉尔伽美什</h3>
              <p>人类最古老的英雄王。他的宝库中现在包含了来自全宇宙的各种科技武器，能够应对任何战况。</p>
              <p class="event-description">特长：远程打击、资源丰富、压倒性火力</p>
            </label>
          </div>

          <div class="selection-option" data-value="库·丘林">
            <input type="radio" name="servant" id="servant3" value="库·丘林">
            <label for="servant3">
              <h3>库·丘林</h3>
              <p>爱尔兰神话中的光之子，以迅捷闻名。他的魔枪被改造成能穿透任何护盾的武器。</p>
              <p class="event-description">特长：高机动性、精准打击、死战不退</p>
            </label>
          </div>

          <div class="selection-option" data-value="玛修·基列莱特">
            <input type="radio" name="servant" id="servant4" value="玛修·基列莱特">
            <label for="servant4">
              <h3>玛修·基列莱特</h3>
              <p>持有强大防御宝具的亚从者。在宇宙战场上，她的盾牌能形成足以保护整支舰队的能量护盾。</p>
              <p class="event-description">特长：防御工事、掩护撤退、坚守阵地</p>
            </label>
          </div>

          <div class="selection-option" data-value="伊什塔尔">
            <input type="radio" name="servant" id="servant5" value="伊什塔尔">
            <label for="servant5">
              <h3>伊什塔尔</h3>
              <p>美索不达米亚神话中的爱与战争女神。她的权能被调整为能够控制星际航行与战场环境。</p>
              <p class="event-description">特长：环境控制、机动能力、远程支援</p>
            </label>
          </div>

          <div class="selection-option" data-value="太空伊什塔尔">
            <input type="radio" name="servant" id="servant6" value="太空伊什塔尔">
            <label for="servant6">
              <h3>太空伊什塔尔</h3>
              <p>进化适应了宇宙环境的伊什塔尔形态。能够在真空中自由移动，拥有操控星体和宇宙射线的能力。</p>
              <p class="event-description">特长：太空作战、能量操控、适应极端环境</p>
            </label>
          </div>

          <div class="selection-option" data-value="埃列什基伽勒">
            <input type="radio" name="servant" id="servant7" value="埃列什基伽勒">
            <label for="servant7">
              <h3>埃列什基伽勒</h3>
              <p>美索不达米亚冥界女神，掌管死亡与重生。在宇宙中，她能够控制暗物质与引力，创造无法逃脱的领域。</p>
              <p class="event-description">特长：区域控制、防御力场、隐秘行动</p>
            </label>
          </div>

          <div class="selection-option" data-value="埃列什基伽勒(Beast)">
            <input type="radio" name="servant" id="servant8" value="埃列什基伽勒(Beast)">
            <label for="servant8">
              <h3>埃列什基伽勒(Beast)</h3>
              <p>解放了魔兽特性的埃列什基伽勒，拥有压倒性的战斗力与破坏欲望。能够吞噬敌方的生命能量并转化为自身力量。</p>
              <p class="event-description">特长：压倒性力量、恐惧光环、自我恢复</p>
            </label>
          </div>
        </div>
      </section>

      <!-- 选择位置 -->
      <section class="form-section">
        <h2>选择你的起始位置</h2>
        <p>在浩瀚宇宙中，你将从哪里开始你的征程？</p>

        <div class="selection-grid">
          <div class="selection-option" data-value="前线要塞世界">
            <input type="radio" name="location" id="location1" value="前线要塞世界">
            <label for="location1">
              <h3>前线要塞世界</h3>
              <p>位于人类领土边缘的重度武装星球，是抵御外星威胁的第一道防线。</p>
            </label>
          </div>

          <div class="selection-option" data-value="帝国核心世界">
            <input type="radio" name="location" id="location2" value="帝国核心世界">
            <label for="location2">
              <h3>帝国核心世界</h3>
              <p>人类文明的中心，拥有最先进的技术和资源，但政治斗争激烈。</p>
            </label>
          </div>

          <div class="selection-option" data-value="边缘殖民地">
            <input type="radio" name="location" id="location3" value="边缘殖民地">
            <label for="location3">
              <h3>边缘殖民地</h3>
              <p>远离中央政权的自治星球，资源稀缺但自由度高，适合独立行动。</p>
            </label>
          </div>

          <div class="selection-option" data-value="亚空间站点">
            <input type="radio" name="location" id="location4" value="亚空间站点">
            <label for="location4">
              <h3>亚空间站点</h3>
              <p>建立在现实与亚空间交界处的研究基地，充满神秘与危险。</p>
            </label>
          </div>
        </div>
      </section>

      <!-- 选择初始状态 -->
      <section class="form-section">
        <h2>选择你的初始状态</h2>
        <p>选择影响你开局的关键因素（可多选）</p>

        <div class="selection-grid">
          <div class="selection-option" data-value="老兵">
            <input type="checkbox" name="status" id="status1" value="老兵">
            <label for="status1">
              <h3>老兵</h3>
              <p>你是一位经验丰富的战士，熟悉各种战术和武器。</p>
              <p class="event-description">影响：战斗能力+15%，但对新技术适应慢</p>
            </label>
          </div>

          <div class="selection-option" data-value="技术专家">
            <input type="checkbox" name="status" id="status2" value="技术专家">
            <label for="status2">
              <h3>技术专家</h3>
              <p>你精通各种高科技设备的操作和维修。</p>
              <p class="event-description">影响：科技能力+20%，但体能较差</p>
            </label>
          </div>

          <div class="selection-option" data-value="战术指挥官">
            <input type="checkbox" name="status" id="status3" value="战术指挥官">
            <label for="status3">
              <h3>战术指挥官</h3>
              <p>你擅长分析局势并制定作战计划。</p>
              <p class="event-description">影响：指挥能力+25%，但前线作战能力较弱</p>
            </label>
          </div>

          <div class="selection-option" data-value="政治避难者">
            <input type="checkbox" name="status" id="status4" value="政治避难者">
            <label for="status4">
              <h3>政治避难者</h3>
              <p>你因政治立场被迫逃离家乡，拥有特殊的人脉关系。</p>
              <p class="event-description">影响：外交能力+15%，但某些派系对你有敌意</p>
            </label>
          </div>

          <div class="selection-option" data-value="亚空间专家">
            <input type="checkbox" name="status" id="status5" value="亚空间专家">
            <label for="status5">
              <h3>亚空间专家</h3>
              <p>你对亚空间现象有深入研究，能预测并利用其异常现象。</p>
              <p class="event-description">影响：亚空间抗性+30%，但精神稳定性较低</p>
            </label>
          </div>
        </div>
      </section>

      <!-- 选择开局事件 -->
      <section class="form-section">
        <h2>选择开局事件</h2>
        <p>你将面临什么样的首次挑战？</p>

        <div class="selection-grid">
          <div class="selection-option" data-value="坚守要塞星球">
            <input type="radio" name="event" id="event1" value="坚守要塞星球">
            <label for="event1">
              <h3>坚守要塞星球</h3>
              <p>星域边缘的要塞星球正遭受大规模外星舰队的围攻，你必须组织防御并坚守到援军到来。</p>
              <p class="event-description">挑战：持久战、资源管理、防御工事</p>
            </label>
          </div>

          <div class="selection-option" data-value="救援难民">
            <input type="radio" name="event" id="event2" value="救援难民">
            <label for="event2">
              <h3>救援难民</h3>
              <p>一颗殖民星球遭到入侵，数百万平民等待撤离，你需要在敌人完全占领前组织大规模救援行动。</p>
              <p class="event-description">挑战：时间压力、民众保护、撤退路线</p>
            </label>
          </div>

          <div class="selection-option" data-value="突袭外星人舰队">
            <input type="radio" name="event" id="event3" value="突袭外星人舰队">
            <label for="event3">
              <h3>突袭外星人舰队</h3>
              <p>情报显示敌方主力舰队正在集结，你必须领导一支突击小队，在他们发动全面进攻前摧毁其指挥中心。</p>
              <p class="event-description">挑战：隐蔽行动、精确打击、时间限制</p>
            </label>
          </div>

          <div class="selection-option" data-value="遭遇亚空间风暴">
            <input type="radio" name="event" id="event4" value="遭遇亚空间风暴">
            <label for="event4">
              <h3>遭遇亚空间风暴</h3>
              <p>在例行巡航中，你的舰队遭遇了罕见的亚空间风暴，被卷入了未知区域，面临着诡异的现象和潜在的敌人。</p>
              <p class="event-description">挑战：亚空间恐惧、导航危机、未知威胁</p>
            </label>
          </div>
        </div>
      </section>

      <!-- 附加说明 -->
      <section class="form-section">
        <h2>附加背景（可选）</h2>
        <p>添加你角色的其他信息或特殊请求</p>

        <div class="form-group">
          <textarea id="additional-info" placeholder="在这里输入你的角色背景故事或其他你希望考虑的因素..."></textarea>
        </div>
      </section>

      <button id="submit-form">确认选择并开始旅程</button>
    </div>

    <!-- 总结页面 -->
    <div id="summary-page">
      <h2>你的命运已铸就</h2>
      <div class="aquila">≡][≡</div>

      <div class="summary-content">
        <!-- 将会通过JS动态填充 -->
      </div>

      <button id="start-journey">开始你的征程</button>
    </div>
  </div>

  <script>
    // 选项选择逻辑
    document.querySelectorAll('.selection-option').forEach(option => {
      option.addEventListener('click', function () {
        const input = this.querySelector('input');

        if (input.type === 'radio') {
          // 取消同组其他选项的选中状态
          document.querySelectorAll(`input[name="${input.name}"]`).forEach(radio => {
            radio.parentElement.classList.remove('selected');
          });
          this.classList.add('selected');
          input.checked = true;
        } else if (input.type === 'checkbox') {
          this.classList.toggle('selected');
          input.checked = !input.checked;
        }
      });
    });

    // 表单提交处理
    document.getElementById('submit-form').addEventListener('click', function () {
      // 验证必填选项
      const faction = document.querySelector('input[name="faction"]:checked')?.value;
      const servant = document.querySelector('input[name="servant"]:checked')?.value;
      const location = document.querySelector('input[name="location"]:checked')?.value;
      const event = document.querySelector('input[name="event"]:checked')?.value;

      if (!faction || !servant || !location || !event) {
        alert('请确保选择了阵营、从者、位置和开局事件！');
        return;
      }

      // 获取多选项
      const statusElements = document.querySelectorAll('input[name="status"]:checked');
      const statusValues = Array.from(statusElements).map(el => el.value);
      const status = statusValues.length > 0 ? statusValues.join('、') : '未选择';

      const additionalInfo = document.getElementById('additional-info').value.trim() || '无';

      // 创建总结内容
      const summaryContent = `
        <div class="summary-item">
          <h3>你的阵营</h3>
          <p>${faction}</p>
        </div>
        <div class="summary-item">
          <h3>你的契约从者</h3>
          <p>${servant}</p>
        </div>
        <div class="summary-item">
          <h3>起始位置</h3>
          <p>${location}</p>
        </div>
        <div class="summary-item">
          <h3>初始状态</h3>
          <p>${status}</p>
        </div>
        <div class="summary-item">
          <h3>开局事件</h3>
          <p>${event}</p>
        </div>
        <div class="summary-item">
          <h3>附加背景</h3>
          <p>${additionalInfo}</p>
        </div>
      `;

      // 显示总结页面
      document.querySelector('.summary-content').innerHTML = summaryContent;
      document.getElementById('creation-form').style.display = 'none';
      document.getElementById('summary-page').style.display = 'block';

      // 保存选择用于发送
      window.characterSelections = {
        faction: faction,
        servant: servant,
        location: location,
        status: status,
        event: event,
        additionalInfo: additionalInfo
      };

      // 滚动到页面顶部
      window.scrollTo(0, 0);
    });

    // 开始旅程按钮 - 发送消息给AI并触发快速回复
    document.getElementById('start-journey').addEventListener('click', function () {
      // 获取之前存储的选择
      const selections = window.characterSelections;
      if (!selections) return;

      // 构建发送的消息
      const messageContent = `我已经做好了角色设定的选择：

**阵营**: ${selections.faction}
**契约从者**: ${selections.servant}
**起始位置**: ${selections.location}
**初始状态**: ${selections.status}
**开局事件**: ${selections.event}
${selections.additionalInfo !== '无' ? `**附加背景**: ${selections.additionalInfo}` : ''}

请根据我的选择，开始这场战锤40K风格的太空冒险！`;

      // 使用slash命令发送消息并触发响应
      try {
        // 创建slash命令数组
        const commands = [];

        // 添加发送消息命令
        commands.push(`/send ${messageContent}`);

        // 添加触发AI回复命令
        commands.push('/trigger');

        // 使用triggerSlash函数执行命令
        if (typeof triggerSlash === 'function') {
          // 执行前尝试关闭iframe
          try {
            if (window.parent && window.parent !== window) {
              window.parent.postMessage({ event_type: 'CLOSE_IFRAME' }, '*');

              // 给予框架关闭的时间
              setTimeout(function () {
                triggerSlash(commands.join('|'));
              }, 100);
            } else {
              triggerSlash(commands.join('|'));
            }
          } catch (e) {
            console.error('执行triggerSlash时出错:', e);
            triggerSlash(commands.join('|')); // 如果关闭iframe失败，仍然尝试执行命令
          }

          console.log('通过triggerSlash发送了以下命令:', commands.join('|'));
        }
        // 回退方案1: 尝试使用其他ST API函数
        else if (typeof executeSlashCommands === 'function') {
          executeSlashCommands(commands.join('|'));
          console.log('通过executeSlashCommands发送了以下命令:', commands.join('|'));
        }
        // 回退方案2: 使用事件系统
        else if (typeof eventEmit === 'function') {
          // 先尝试关闭iframe
          if (window.parent && window.parent !== window) {
            window.parent.postMessage({ event_type: 'CLOSE_IFRAME' }, '*');
          }

          setTimeout(function () {
            // 发送用户消息
            eventEmit('USER_MESSAGE_SENT', messageContent);

            // 稍后触发生成
            setTimeout(function () {
              eventEmit('GENERATE_CLICKED', {});
            }, 100);
          }, 100);

          console.log('通过事件系统发送了消息');
        }
        // 回退方案3: 直接调用API
        else if (typeof sendMessageAs === 'function' && typeof Generate === 'function') {
          // 关闭iframe
          if (window.parent && window.parent !== window) {
            window.parent.postMessage({ event_type: 'CLOSE_IFRAME' }, '*');
          }

          setTimeout(function () {
            sendMessageAs('user', messageContent);
            setTimeout(Generate, 100);
          }, 100);

          console.log('通过直接API发送了消息');
        }
        // 回退方案4: 使用postMessage API
        else if (window.parent && window.parent !== window) {
          // 关闭iframe
          window.parent.postMessage({ event_type: 'CLOSE_IFRAME' }, '*');

          // 发送slash命令
          setTimeout(function () {
            window.parent.postMessage({
              event_type: 'EXECUTE_SLASH_COMMANDS',
              data: commands.join('|')
            }, '*');

            console.log('通过postMessage发送了命令');
          }, 100);
        }
        // 最终回退: 复制到剪贴板
        else {
          const copyText = document.createElement('textarea');
          copyText.value = messageContent;
          document.body.appendChild(copyText);
          copyText.select();
          document.execCommand('copy');
          document.body.removeChild(copyText);

          alert('无法自动发送消息，但已将内容复制到剪贴板。请手动粘贴到聊天窗口。');
        }
      } catch (error) {
        console.error('发送消息时出错:', error);

        // 提供备用方法 - 复制到剪贴板
        const copyText = document.createElement('textarea');
        copyText.value = messageContent;
        document.body.appendChild(copyText);
        copyText.select();
        document.execCommand('copy');
        document.body.removeChild(copyText);

        alert('无法自动发送消息，但已将内容复制到剪贴板。请手动粘贴到聊天窗口。');
      }
    });

    // 初始化 - 预先选中一些默认选项，改善用户体验
    window.addEventListener('DOMContentLoaded', function () {
      // 可以预设一些默认值，让用户体验更好
      const presetDefaults = false; // 设为true可启用预设默认值

      if (presetDefaults) {
        // 选中第一个阵营
        document.querySelector('input[name="faction"]').click();
        // 选中伊什塔尔作为默认从者
        document.querySelector('input[value="伊什塔尔"]').click();
      }
    });
  </script>
</body>

</html>
```