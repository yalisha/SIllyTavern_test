<!-- 1. 更新特殊技能映射 -->
const specialSkillText = {
'puppet': '魔偶',
'print_cage': '印笼技能',
'ares': '战神阿瑞斯 ARES',
'golden_armor': 'GOLDEN 大具足',
'god_bazooka': '神之巴祖卡',
'anti_beast': '对兽魔术'
};

// Replace with:

const specialSkillText = {
'puppet': '魔偶',
'print_cage': '印笼技能',
'ares': '战神阿瑞斯 ARES',
'golden_armor': 'GOLDEN 大具足',
'god_bazooka': '神之巴祖卡',
'anti_beast': '对兽魔术',
'desire_resonance': '欲望共振',
'emotion_circuit': '情感回路',
'blade_of_dread': '恐惧之刃',
'desire_engine': '机械欲望引擎',
'sacred_desire_shift': '圣欲转化',
'warflame_ignition': '战意燃烧',
'stellar_desire': '星欲映射'
};

<!-- 2. 修改宝具1描述为色情化中国古典文风 -->
<!-- 宝具1 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np1" value="抑止封杀·堕兽毒牙" onclick="selectNoblePhantasm(this.value)">
  <label for="np1" class="noble-phantasm-title">【抑止封杀·堕兽毒牙】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：A</span>
    <span class="noble-phantasm-property">类型：对【抑止力】宝具</span>
  </div>
  <p>效果：通过积累人类社会的"罪"与负面情感（如憎恨、攀比等）转化为攻击能量，释放出足以污染人理的"毒牙"。宝具附带【灼烧】效果，象征对人类文明矛盾的否定与净化。</p>
  <p>背景：若<user>因对人理的失望而依凭凯茜帕鲁格（Beast IV）的灵基，此宝具将体现其作为"比较之兽"的权能，以"罪"为燃料发动毁灭性打击。</p>
</div>

// Replace with:

<!-- 宝具1 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np1" value="抑止封杀·堕兽毒牙" onclick="selectNoblePhantasm(this.value)">
  <label for="np1" class="noble-phantasm-title">【抑止封杀·堕兽毒牙】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：A</span>
    <span class="noble-phantasm-property">类型：对【抑止力】宝具</span>
  </div>
  <p>效果：凝集世间男女欢愉之时淫声浪语，汇聚为至阴至阳之能，化作穿透万物的"欲望毒牙"。宝具发动时，万千男女欢爱幻象环绕，令敌方沉溺其中，心神失守。敌方承受宝具伤害同时，浑身热流涌动，痛与乐并生，犹如经历绝顶之欢。</p>
  <p>背景：若君主因对世间欲海之深沉而心神往之，则此宝具将化为极乐的象征，能使敌方在销魂蚀骨之时，肉体精华尽失。此宝具发动时，周围空气如春帐之内，沁人心脾，令人春情难禁。</p>
</div>

<!-- 3. 修改宝具2描述为色情化中国古典文风 -->
<!-- 宝具2 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np2" value="不被知晓的遥远之星" onclick="selectNoblePhantasm(this.value)">
  <label for="np2" class="noble-phantasm-title">【不被知晓的遥远之星】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：A~EX</span>
    <span class="noble-phantasm-property">类型：对存在宝具</span>
  </div>
  <p>效果：将<user>"凡人救世主"的概念实体化，发射包含其无名功绩、记忆与羁绊的能量洪流。攻击可无视防御与灵基规模，但代价是自身灵基崩坏或长期沉睡。</p>
  <p>特色：结合了玛修盾牌的守护属性与圣剑基形的攻击性，象征其"无名英雄"的本质。宝具台词可能关联其拯救世界的孤独感，如"此身即为人理最后的证明"。</p>
</div>

// Replace with:

<!-- 宝具2 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np2" value="不被知晓的遥远之星" onclick="selectNoblePhantasm(this.value)">
  <label for="np2" class="noble-phantasm-title">【不被知晓的遥远之星】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：A~EX</span>
    <span class="noble-phantasm-property">类型：对存在宝具</span>
  </div>
  <p>效果：御主浑身绽放绮丽光华，如牡丹初绽，摇曳生姿。清辉万道，使对方神魂摇曳，情动不能自已。此宝具化实为虚，化虚为实，将御主体内若隐若现的"春意"释放，使敌方如醉春风，酥软无力。每逢宝具展开，周围空气中弥漫着兰麝之香，令人欲念丛生。
  </p>
  <p>特色：宝具形似笙歌起处，百花争艳，其中蕴含万般柔情，胜却人间无数。每当宝具发动，御主身上散发出如兰似麝之气息，令人欲火焚身，难以自持。御主轻吟："此身若桃花，为君独绽放"，令敌方神魂颠倒，甘愿臣服。</p>
</div>

<!-- 4. 修改宝具3描述为色情化中国古典文风 -->
<!-- 宝具3 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np3" value="回应吧，穿越遥远的彼方" onclick="selectNoblePhantasm(this.value)">
  <label for="np3" class="noble-phantasm-title">【回应吧，穿越遥远的彼方】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：EX</span>
    <span class="noble-phantasm-property">类型：对世界宝具</span>
  </div>
  <p>效果：通过献祭自身灵基，召唤与其羁绊深厚的从者。该宝具仅在极端危机下发动，体现其"牺牲自我换取希望"的特质。</p>
  <p>机制：类似"冠位指定"技能，需燃烧灵基换取临时冠位级战力，契合<user>作为"凡人御主"的极限抉择。</p>
</div>

// Replace with:

<!-- 宝具3 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np3" value="回应吧，穿越遥远的彼方" onclick="selectNoblePhantasm(this.value)">
  <label for="np3" class="noble-phantasm-title">【回应吧，穿越遥远的彼方】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：EX</span>
    <span class="noble-phantasm-property">类型：对世界宝具</span>
  </div>
  <p>效果：御主裸裎其身，犹如春江水暖，樱花初绽，体表泛起如玉般润泽光华。御主情动之际，体内阴阳之气交融，贯通六脉，引得诸多从者心神共鸣。当宝具展开，周围空气化作春水，使人如置温泉，浑身酥麻，欲火难耐。</p>
  <p>机制：御主须解衣宽带，展露玉体，心中思念与其鱼水之欢的从者。心神合一之时，御主体内真气上涌，玉茎挺立（若为女性则玉门含露），引动天地灵气，召唤心系之人现世。此时御主神魂摇曳，丹田气涌，如登极乐，酥软无力，足令敌方望之心神俱失。
  </p>
</div>

<!-- 5. 修改宝具4描述为色情化中国古典文风 -->
<!-- 宝具4 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np4" value="磷火噬却·终末黎明" onclick="selectNoblePhantasm(this.value)">
  <label for="np4" class="noble-phantasm-title">【磷火噬却·终末黎明】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：EX</span>
    <span class="noble-phantasm-property">类型：对文明宝具</span>
  </div>
  <p>效果：若<user>因绝望堕为Beast，此宝具将具现化其对人理的"扭曲之爱"，以白之兽的火焰焚烧世界，同时赋予敌方【自我毁灭】状态（即因内部矛盾自毁）。</p>
  <p>设定依据：参考"惨白的兽心EX"技能，结合凯茜帕鲁格吞噬黎明、引发末日的特性。</p>
</div>

// Replace with:

<!-- 宝具4 -->
<div class="noble-phantasm-card">
  <input type="radio" name="noblePhantasm" id="np4" value="磷火噬却·终末黎明" onclick="selectNoblePhantasm(this.value)">
  <label for="np4" class="noble-phantasm-title">【磷火噬却·终末黎明】</label>
  <div class="noble-phantasm-properties">
    <span class="noble-phantasm-property">等级：EX</span>
    <span class="noble-phantasm-property">类型：对文明宝具</span>
  </div>
  <p>
    效果：御主身化白玉之躯，肌肤胜雪，引天地阴阳二气交合，生出青白色"磷火"，此火非烧肉身，而专燃情欲。敌方为此火所染，不觉裸裎其体，如饥似渴，难耐寂寞。男子阳物挺拔，如玉柱擎天；女子玉门流溢，若桃花带雨，不得云雨之欢则会体内灼热难耐，七窍流血而亡。
  </p>
  <p>设定依据：此宝具发动时，御主先浑身泛起红晕，春情难抑，而后化作纯白之兽，浑身散发淫靡之气。周围空气化作莲池春水，令人如堕温柔乡，欲罢不能。百丈之内，生灵受其影响，皆欲行鱼水之欢，云雨之事，不得满足则焚身而亡。</p>
</div>

<!-- 6. 添加技能描述变量到 generateDetailedSummary() 函数 -->
function generateDetailedSummary() {
// Map values to readable Chinese text
const genderText = {
'male': '男性',
'female': '女性',
'futa': '扶他',
'femboy': '男身女相'
};

const mysticCodeText = {
'mystic_code_chaldea': '魔术礼装·迦勒底',
'mystic_code_chaldea_combat': '魔术礼装·迦勒底战斗服',
'mystic_code_association': '魔术礼装·魔术协会制服',
'mystic_code_atlas': '魔术礼装·阿特拉斯院制服',
'golden_celebration': '金色庆典',
'bright_summer': '明亮夏日',
'memories_of_lunar_sea': '月之海的记忆',
'polar_chaldea': '极地用制服',
'tropical_summer': '热带夏日',
'fifth_true_element': '第五真说要素环境用制服',
'explorer_uniform': '童子军服',
'winter_casual': '冬日便装'
};

const specialSkillText = {
'puppet': '魔偶',
'print_cage': '印笼技能',
'ares': '战神阿瑞斯 ARES',
'golden_armor': 'GOLDEN 大具足',
'god_bazooka': '神之巴祖卡',
'anti_beast': '对兽魔术',
'desire_resonance': '欲望共振',
'emotion_circuit': '情感回路',
'blade_of_dread': '恐惧之刃',
'desire_engine': '机械欲望引擎',
'sacred_desire_shift': '圣欲转化',
'warflame_ignition': '战意燃烧',
'stellar_desire': '星欲映射'
};

const playerTraitText = {
'lustful_curse': '淫神诅咒（所接触到的东西都会色情化）',
'fragile_cauldron': '易碎鼎炉（看起来娇弱但又好吃）',
'wish_fulfillment': '心想事成（拥有心想事成的能力）',
'hypnosis_master': '催眠大师（可以催眠普通人，甚至从者）',
'sex_king': '性爱之王（谁都想被<user>做爱）',
  'seduction_king': '诱惑之王（谁都想跟<user>做爱）',
    'lady_training': '淑女修行（强制戴着外表美丽的调教用具）',
    'training_master': '调教大师（可以轻松的使人恶堕）',
    'none': '无特殊特质'
    };

    // Add specialSkillDescriptions for new skills
    const specialSkillDescriptions = {
    'desire_resonance': '欲望共振（Desire Resonance）-
    通过接触目标（人类或从者），读取并具现其内心最深处的欲望，转化为魔力或战斗增益。每次使用需消耗一单位魔力，若目标意志强大，则可能反噬，使使用者短暂陷入混乱。',
    'emotion_circuit': '情感回路（Emotion Circuit）- 将自身或他人的强烈情感转化为临时魔术回路，提升魔力输出或从者能力。情感越强烈，效果越显著，但若情绪失控，魔力会反噬自身。',
    'blade_of_dread': '恐惧之刃（Blade of Dread）- 将目标的恐惧或欲望凝结为实体武器，攻击力随目标情绪强度而增强。武器存在时间有限，需持续消耗魔力维持，且无法对无恐惧者生效。',
    'desire_engine': '机械欲望引擎（Mechanized Desire Engine）- 将欲望能量注入机械装置，制造临时魔术道具或强化从者装备。装置效果与注入的欲望强度成正比，但过载会导致爆炸。',
    'sacred_desire_shift': '圣欲转化（Sacred Desire Shift）- 将信仰之力与欲望之力互相转化，用于治疗、攻击或强化从者。转化过程需保持内心平衡，否则会导致魔力失控或精神崩溃。',
    'warflame_ignition': '战意燃烧（Warflame Ignition）- 将战斗中的杀意与生存欲转化为魔力火焰，提升自身与从者的战斗能力。技能持续时间与战斗激烈程度相关，结束后会陷入短暂虚弱。',
    'stellar_desire': '星欲映射（Stellar Desire Mapping）- 将目标的欲望映射至星空，召唤星辰之力进行攻击或辅助。需夜晚或星光可见时使用，白天效果减弱。'
    };

    const startPointMap = {
    'fuyuki_normal': '燃烧污染都市 冬木（对魔术一无所知，没有关于两位女神的记忆）',
    'fuyuki_mage': '燃烧污染都市 冬木（本地魔术师，没有关于两位女神的记忆，但有些许印象）',
    'fuyuki_chaldea': '燃烧污染都市 冬木（迦勒底成员）',

    // Add after the special skill is added to the summary, before the Noble Phantasm section
    // Special skill with description
    let skillName = specialSkillText[playerData.specialSkill] || '未选择';
    summary += `◆ 特殊技能：${skillName}\n`;
    if (playerData.specialSkill && specialSkillDescriptions[playerData.specialSkill]) {
    summary += ` 描述：${specialSkillDescriptions[playerData.specialSkill]}\n`;
    }

    // Noble Phantasm
    if (playerData.noblePhantasm === 'custom') {