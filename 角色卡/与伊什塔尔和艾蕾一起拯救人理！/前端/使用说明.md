# 与伊什塔尔和艾蕾一起拯救人理！ - 使用指南

本指南将帮助您理解如何使用游戏UI系统和所需的正则表达式，以便在SillyTavern中获得最佳体验。

## 目录

1. [系统概述](#系统概述)
2. [文件说明](#文件说明)
3. [开局UI使用指南](#开局ui使用指南)
4. [段落UI使用指南](#段落ui使用指南)
5. [正则表达式设置](#正则表达式设置)
6. [游戏命令系统](#游戏命令系统)
7. [进阶提示](#进阶提示)

## 系统概述

本游戏基于FGO（Fate/Grand Order）世界观，让玩家扮演一位迦勒底的御主，与伊什塔尔和艾蕾一起拯救人理。游戏系统包含以下主要功能：

- 角色创建与定制
- 从者关系系统（好感度、调教度）
- 令咒系统
- 魔术礼装与技能系统
- 宝具系统
- 特异点探索

## 文件说明

游戏包含以下核心文件：

- `开局.html`: 游戏初始化界面，用于创建角色
- `段落.html`: 游戏主界面，包含剧情、从者信息、世界状态和玩家状态
- `魔术礼装.json`: 包含所有魔术礼装、特殊技能的数据
- 其他辅助文件

## 开局UI使用指南

1. **打开开局UI**：在聊天开始时，通过正则表达式自动触发开局界面
2. **角色创建流程**：
   - 第一阶段：选择性别和魔术资质
   - 第二阶段：选择魔术礼装和特殊技能
   - 第三阶段：选择/创建宝具
   - 第四阶段：设置从者好感度和调教度
   - 第五阶段：选择剧情开局点
   - 第六阶段：确认所有选择并开始游戏

3. **确认选择**：点击"确认开始游戏"按钮，系统会将所有数据发送至AI，开始游戏

## 段落UI使用指南

段落UI共有四个主要标签页，可通过点击切换：

### 1. 剧情标签页
- 显示当前剧情内容
- 内容由AI动态生成

### 2. 从者标签页
- 显示伊什塔尔和艾蕾的状态信息
- 包括好感度、调教度、称谓等信息
- 使用进度条直观展示数值

### 3. 世界标签页
- 显示当前特异点信息
- 世界概况描述
- 关键NPC列表及状态

### 4. 御主标签页
- 显示玩家角色状态
- 令咒系统（包括数量和恢复时间）
- 基本信息（性别、魔术资质等）
- 装备信息（魔术礼装、特殊技能）
- 宝具信息

## 正则表达式设置

为确保UI系统正常工作，需在SillyTavern中设置以下正则表达式：

### 开局UI触发正则
将此正则添加到"开局"触发器中，关联到`开局.html`文件：

```regex
^(让我们|准备好|开始|启动|初始化|创建角色|开局|我想开始)(游戏|冒险|FGO|拯救人理).*
```

### 段落UI触发正则
将此正则添加到"段落"触发器中，关联到`段落.html`文件：

```regex
(?<=\n|^)(?:<UI更新>|<游戏状态>|<状态更新>)([\s\S]*?)(?:<\/UI更新>|<\/游戏状态>|<\/状态更新>)
```

### 游戏数据解析正则
用于解析游戏内AI返回的JSON格式数据：

```regex
(?<=\n|^)<游戏数据>([\s\S]*?)<\/游戏数据>
```

## 游戏命令系统

玩家可以通过以下命令与游戏系统交互：

### 基础命令
- `/status` 或 `状态查询`: 查看当前游戏状态
- `/use 技能名称`: 使用魔术礼装技能
- `/command_seal 指令`: 使用令咒（例如：`/command_seal 宝具充能`）
- `/relationship 从者名`: 查看与特定从者的关系详情

### 战斗命令
- `/battle`: 进入战斗模式
- `/attack 目标`: 对目标发动普通攻击
- `/skill 技能编号 [目标]`: 使用编号对应的技能
- `/noble_phantasm [目标]`: 释放宝具

### 探索命令
- `/explore`: 探索当前区域
- `/move 位置`: 移动到指定位置
- `/interact NPC名称`: 与指定NPC互动

## 进阶提示

1. **数据持久化**：游戏数据会通过SillyTavern的变量系统保存，确保不会因刷新页面而丢失

2. **变量名规范**：
   - 玩家基本信息: `player_gender`, `player_aptitude` 等
   - 从者信息: `ishtar_affection`, `eresh_training` 等
   - 游戏进度: `current_singularity`, `repair_progress` 等
   - 装备信息: `mystic_code`, `special_skill` 等

3. **快捷键**：
   - `Tab`: 切换标签页
   - `Space`: 在剧情页面显示下一段对话
   - `E`: 打开御主状态页
   - `S`: 打开从者状态页

4. **调试模式**：在聊天框中输入 `/debug` 可以启用调试模式，显示更多技术细节

5. **备用命令**：如果UI不响应，可以使用文本命令：`@游戏 状态查询`，效果与点击UI相同

## 常见问题解答

**Q: 游戏数据没有正确加载怎么办？**  
A: 尝试在聊天框中输入 `/reset_ui` 重新加载界面

**Q: 如何修改已创建角色的属性？**  
A: 使用命令 `/edit 属性名 新值`，例如 `/edit player_gender female`

**Q: 从者好感度/调教度如何提升？**  
A: 通过剧情选择和特定互动可提升这些值，AI会根据您的选择动态调整

**Q: 令咒使用后如何恢复？**  
A: 系统会自动按游戏内时间计算恢复，一般为24小时恢复一划 