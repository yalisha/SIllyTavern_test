# 《与伊什塔尔和艾蕾一起拯救人理！》提示词使用说明

## 介绍

本文档介绍如何使用提供的AI提示词格式来生成符合"段落.html"需求的输出内容。这个提示词格式设计用于在SillyTavern中使用，能够自动更新游戏UI并保持游戏状态的一致性。

## 提示词格式说明

提示词格式位于`提示词格式.txt`文件中，其结构包含以下主要部分：

1. **UI更新标记** `<UI更新>` - 用于触发游戏UI显示
2. **游戏数据** `<游戏数据>` - JSON格式的游戏状态数据
3. **剧情内容** `<剧情>` - 主要的故事内容
4. **额外提示** - 标签外的内容会被用作玩家选项或提示

## 如何使用

1. 复制`提示词格式.txt`中的内容作为AI提示词
2. 根据当前游戏进展，修改提示词中的占位符为适当的值
3. 将修改后的提示词发送给AI，生成符合格式的响应

## 数据结构解释

### 玩家数据 (player)

* `gender` - 玩家性别
* `magicAptitude` - 魔术资质描述
* `status` - 当前状态 (正常/警戒/受伤等)
* `location` - 当前位置
* `mysticCode` - 当前装备的魔术礼装
* `specialSkill` - 特殊技能
* `noblePhantasm` - 宝具信息 (名称/类型/描述)
* `commandSeals` - 剩余令咒数量 (0-3)

### 从者数据 (servants)

每个从者 (伊什塔尔/艾蕾) 包含：
* `affection` - 好感度 (0-100)
* `training` - 调教度 (0-100)
* `title` - 对主人的称呼
* `status` - 当前状态
* `location` - 当前位置

### 世界数据 (world)

* `singularityName` - 特异点名称
* `dangerLevel` - 危险等级 (低/中/高/极高)
* `repairProgress` - 修复进度 (0-100)
* `description` - 世界概况描述
* `npcs` - NPC列表及其状态

## 示例

查看`示例响应.txt`文件获取完整的响应示例。

## 注意事项

1. 确保JSON格式正确，否则游戏UI将无法正常解析数据
2. 所有的标签（`<UI更新>`, `<游戏数据>`, `<剧情>`）都是必须的
3. 数值型字段（如好感度）应保持在指定范围内
4. 剧情内容应保持连贯性，与游戏数据相匹配
5. **不要使用额外的包装标签**，如`<outputcontent>`，它们会干扰数据提取

## 与段落.html的交互

段落.html文件通过JavaScript代码自动解析AI输出中的游戏数据和剧情内容，并更新UI显示。具体交互过程：

1. AI的输出通过SillyTavern传递给iframe
2. `DataExtractor`对象从输出中提取游戏数据和剧情内容：
   - 使用`<游戏数据>`标签提取JSON格式的游戏状态
   - 使用`<剧情>`标签提取故事内容
3. `UIUpdater`对象根据提取的数据更新UI：
   - 更新玩家状态（性别、位置、魔术礼装等）
   - 更新从者信息（好感度、调教度、状态等）
   - 更新世界信息（特异点数据、NPC等）
   - 更新剧情显示

格式正确的输出将激活所有UI元素，包括：
- 剧情页面的故事内容
- 从者页面的从者状态
- 世界页面的特异点信息
- 玩家页面的个人状态和令咒显示

## 故障排除

如果游戏UI未能正确更新，请检查：

1. 提示词格式是否完整，标签是否正确闭合
2. JSON数据是否有语法错误（缺少逗号、引号不匹配等）
3. 是否误用了额外的包装标签如`<outputcontent>`
4. 系统是否正确识别了`<UI更新>`标签
5. 浏览器控制台是否有JavaScript错误提示 